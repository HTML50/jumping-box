<!DOCTYPE html>
<html>
<head>
<title>jumping box</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=0.8, user-scalable=no">
<style>
body {margin:0;padding:0}
canvas {
border-bottom:10px solid #9b59b6;
}

</style>
</head>
<body>
<div style="width:650px;height:350px;margin:0 auto;">
<canvas id="player" width="650" height="350" style="position:absolute;z-index:421;"></canvas>
<canvas id="background" width="650" height="350" style="position:absolute;z-index:331;"></canvas>
<canvas id="canvas" width="650" height="350" style="position:absolute;z-index:421;"></canvas>
<canvas id="canvas1" width="650" height="350" style="position:absolute;z-index:421;"></canvas>
<canvas id="canvas2" width="650" height="350" style="position:absolute;z-index:421;"></canvas>
<canvas id="canvas3" width="650" height="350" style="position:absolute;z-index:421;"></canvas>
<canvas id="canvas4" width="650" height="350" style="position:absolute;z-index:421;"></canvas>
<canvas id="canvas5" width="650" height="350" style="position:absolute;z-index:421;"></canvas>
</div>


<audio loop="loop" id="Background-AudioPlayer" preload="auto">
	<source src="audio/music.wav" type="audio/wav"/ >
	</audio>
	<audio id="GameOver-AudioPlayer" preload="auto">
	<source src="audio/hit.wav" type="audio/wav">
	</audio>
	<audio id="Jump-AudioPlayer" preload="auto">
	<source src="audio/jump.wav" type="audio/wav"/>
	</audio>
<script>






var backgroundAudio = document.getElementById("Background-AudioPlayer");
var jumpAudio = document.getElementById("Jump-AudioPlayer");
var gameoverAudio = document.getElementById("GameOver-AudioPlayer");
var canvas = document.getElementById("player");
var ctx=canvas.getContext("2d");
ctx.fillStyle="#2196f3";
ctx.font = "20px Consolas";

//初始化
ctx.fillText("jumping-box", 245, 150);
ctx.font = "30px Consolas";
ctx.fillText("Loading", 250, 180);
window.onload=function(e){
main();
}



var playerRadius=15;
var death=0;

//X,Y是方块的中心点,初始时是在半空中，准备下落
var playerX;
var playerY;

var playSpeed=1000/60;
var playerMoveSpeed=4;

var jumpProcess;
var moveProcess;


////////////////////////跳跃过程//////////////////


var vt=1000
//起跳速度
var v0=0
var g=4000
var s=0
var t=playSpeed/1000;
var angle=0;
var spin=12

var vFall=0;
var sFall=0

var isJumping = false;
var isStart=false;
var isWin=false;

var level=0;
var levelMap=[
	[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 50, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
	[0, 0, 0, 0, 0, 0, 0, 30, 0, 0, 0, 0, 0, 0, 0, 0, 0, 20, 0, 0, 0, 0, 0, 0, 0],
	[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 80, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
	[0, 0, 0, 0, 0, 0, 80, 0, 0, 0, 0, 0, 80, 0, 0, 0, 0, 0, 80, 0, 0, 0, 0, 0, 0],
	[0, 0, 0, 0, 30, 0, 30, 0, 0, 0, 30, 0, 0, 0, 0, 30, 0, 0, 0, 0, 0, 0, 0, 0, 0],
	[0, 0, 0, 0, 0, 0, 0, 0, 0, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],

	[0, 0, 5, 5, 5, 0, 0, 0, 0, 2, 3, 0, 0, 0, 0, 0, 2, 3, 0, 0, 0, 0, 0, 0, 0],
	[0, 0, 0, 0, 2, 0, 0, 0, 5, 0, 0, 0, 0, 2, 0, 0, 0, 5, 0, 0, 0, 3, 0, 0, 0],
	[0, 0, 0, 0, 2, 3, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 2, 2, 0, 0, 0, 0, 0],
	[0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 1, 2, 3, 0, 0, 0, 0, 0, 0],
	[0, 0, 0, 2, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 2, 0, 0, 0],

	[0, 0, 5, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 4, 0, 0, 0, 0, 0, 2, 0, 0, 0],
	[0, 0, 1, 0, 0, 0, 0, 0, 2, 0, 0, 0, 5, 0, 0, 0, 2, 2, 2, 0, 0, 5, 0, 0, 0],
	[0, 0, 0, 0, 2, 3, 2, 0, 0, 0, 5, 5, 0, 0, 0, 2, 3, 2, 0, 0, 0, 0, 0, 0, 0],
	[0, 0, 0, 0, 2, 2, 2, 0, 0, 0, 0, 0, 3, 0, 0, 0, 5, 0, 0, 0, 0, 2, 0, 0, 0],
	[0, 0, 0, 0, 0, 4, 0, 0, 0, 0, 0, 4, 0, 0, 0, 0, 0, 0, 4, 0, 0, 0, 0, 0, 0],

	[0, 0, 0, 0, 4, 0, 0, 0, 0, 5, 0, 0, 0, 3, 3, 0, 0, 0, 0, 5, 0, 0, 0, 0, 0],
	[0, 0, 0, 0, 0, 5, 0, 0, 2, 2, 0, 0, 0, 0, 5, 5, 0, 0, 0, 4, 0, 0, 0, 0, 0],
	[0, 0, 0, 0, 1, 4, 1, 0, 0, 0, 0, 1, 4, 1, 0, 0, 0, 0, 0, 1, 4, 1, 0, 0, 0],
	[0, 0, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 0, 0, 2, 0, 0, 0, 0, 0]];

//////////////////初始变量///////////////


function keyDown(){
if(!isStart&&!isWin){
	start()
	isStart=true;
	backgroundAudio.play()
	backgroundAudio.volume="0.3"
	}
	else if(!isStart&&isWin){
	reset();
	}
	else if(!isJumping){
	if(moveProcess!=null) clearInterval(moveProcess)
	jump();
	}

}

function touch (event){
        var event = event || window.event;
        switch(event.type){
            case "touchstart":
				keyDown()
                break;
            case "touchmove":
                event.preventDefault();
                keyDown()
                break;
        }
         
    }




//入口
function main(){
ctx.clearRect(0,0,650,200); 
ctx.fillText("Press ANY KEY to jump", canvas.width/4, 150);


addEventListener("keydown", function(e) {
	keyDown()
}, false);
addEventListener('touchstart',touch,false);
addEventListener('touchmove',touch,false);
addEventListener('touchend',touch,false);

}


</script>
<script src="js/scene.js"></script>
<script src="js/game.js"></script>
<script src="js/draw.js"></script>
<script src="js/level.js"></script>
<script src="js/collision.js"></script>
<script src="js/explosive.js"></script>
</body>
</html>